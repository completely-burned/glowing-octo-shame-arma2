private["_unit","_veh"];
_unit = _this;
_veh = vehicle _unit;
if (_unit getvariable "BIS_lifestate" == "ALIVE") then {
	private["_aliveAnimationState"];
	_aliveAnimationState = ["amovppnemstpsraswrfldnon_injured","ainjppnemstpsnonwrfldnon_rolltoback","ainjppnemstpsnonwrfldnon","ainjppnemstpsnonwrfldnon_rolltofront","amovppnemsprslowwrfldf_injured"];
	if (lifestate _unit == "UNCONSCIOUS" or captive _unit or tolower animationState _unit in _aliveAnimationState) then {
		_unit playactionnow "agonyStop";
		_unit setvariable ["BIS_lifeState","ALIVE",true];
		_unit setUnconscious false;
		_unit setcaptive false;
	};
};

if (_unit getvariable "BIS_lifestate" == "UNCONSCIOUS") then {
	if (local _unit) then {
		private["_aliveAnimationState"];
		_aliveAnimationState = ["aidlpercmstpsraswrfldnon_idlesteady02","amovpercmstpsraswrfldnon","aidlpercmstpsraswrfldnon","amovpercmstpslowwrfldnon","aidlpercmstpslowwrfldnon_player_0s","amovpercmstpslowwrfldnon_turnl","amovpercmstpslowwrfldnon_turnr","amovpercmstpslowwrfldnon_amovpknlmstpslowwrfldnon","amovpknlmstpslowwrfldnon","aidlpknlmstpslowwrfldnon_player_0s","aidlpknlmstpslowwrfldnon_player_idlesteady02","amovpknlmstpslowwrfldnon_turnl","amovpknlmstpslowwrfldnon_turnr","amovpknlmstpslowwrfldnon_amovpknlmstpsraswrfldnon","amovpknlmstpsraswrfldnon","amovpknlmstpsraswrfldnon_turnl","amovpknlmstpsraswrfldnon_turnr","amovpknlmstpsraswrfldnon_amovpercmstpsraswrfldnon","amovpercmstpsraswrfldnon_turnl","amovpercmstpsraswrfldnon_turnr","aidlpercmstpsraswrfldnon_aiming0s","amovpercmstpsraswrfldnon_amovpknlmstpsraswrfldnon","amovpknlmwlksraswrfldb","amovpknlmwlksraswrfldl","amovpknlmstpsraswrfldnon_amovppnemstpsraswrfldnon","amovppnemstpsraswrfldnon","amovppnemstpsraswrfldnon_amovpknlmstpsraswrfldnon","aidlpercmstpsraswrfldnon_idlesteady04","aidlpknlmstpslowwrfldnon_player_idlesteady01","amovpknlmstpslowwrfldnon_amovppnemstpsraswrfldnon","amovppnemstpsraswrfldnon_amovpercmstpsraswrfldnon","aidlpercmstpsraswrfldnon_aiming02","amovpercmstpsraswrfldnon_amovppnemstpsraswrfldnon","amovpercmstpslowwrfldnon_amovppnemstpsraswrfldnon","amovppnemstpsraswrfldnon_turnl","amovppnemstpsraswrfldnon_turnr","amovppnemrunslowwrfldb","amovppnemsprslowwrfldb","amovppnemrunslowwrfldr","amovppnemsprslowwrfldr","amovppnemsprslowwrfldfr","amovppnemsprslowwrfldf","amovppnemsprslowwrfldfl","amovppnemsprslowwrfldl","amovppnemsprslowwrfldbl","amovppnemsprslowwrfldbr","amovpknlmwlksraswrfldr","amovpknlmrunsraswrfldr","amovpknlmrunsraswrfldfr","amovpknlmrunsraswrfldf","amovpknlmrunsraswrfldfl","amovpknlmrunsraswrfldl","amovpknlmrunsraswrfldbl","amovpknlmrunsraswrfldb","amovpknlmrunsraswrfldbr","aidlpknlmstpslowwrfldnon_i01","amovpknlmwlkslowwrfldr","amovpknlmrunslowwrfldr","amovpknlmrunslowwrfldfr","amovpknlmrunslowwrfldf","amovpknlmrunslowwrfldfl","amovpknlmrunslowwrfldl","amovpknlmrunslowwrfldbl","amovpknlmrunslowwrfldb","amovpknlmrunslowwrfldbr","amovpknlmstpslowwrfldnon_amovpercmstpslowwrfldnon","amovpercmwlkslowwrfldf","amovpercmrunslowwrfldf","amovpercmrunslowwrfldfl","amovpercmrunslowwrfldl","amovpercmrunslowwrfldbl","amovpercmrunslowwrfldb","amovpercmrunslowwrfldbr","amovpercmrunslowwrfldr","amovpercmrunslowwrfldfr","amovpercmstpslowwrfldnon_amovpercmstpsraswrfldnon","aidlpercmstpsraswrfldnon_idlesteady03","amovpercmwlksraswrfldf","amovpercmrunsraswrfldf","amovpercmrunsraswrfldfl","amovpercmrunsraswrfldl","amovpercmrunsraswrfldbl","amovpercmrunsraswrfldb","amovpercmrunsraswrfldbr","amovpercmrunsraswrfldr","amovpercmrunsraswrfldfr","amovpercmevasraswrfldf","amovpercmevasraswrfldfl","amovpercmevasraswrfldfr","amovpercmsprslowwrfldf_amovppnemstpsraswrfldnon","amovpercmsprslowwrfldf_amovppnemstpsraswrfldnon_2","amovpercmrunslowwrfldf_amovppnemstpsraswrfldnon","aidlpercmstpsraswrfldnon_aiming01","amovppnemrunslowwrfldf","amovppnemstpsraswrfldnon_amovpercmsprslowwrfldf","amovppnemstpsraswrfldnon_amovpercmsprslowwrfldf_2","aidlpercmstpsraswrfldnon_idlesteady01","amovpknlmstpsraswrfldnon_amovpknlmrunslowwrfldf","amovpercmstpsraswrfldnon_ainvpknlmstpslaywrfldnon","ainvpknlmstpslaywrfldnon","ainvpknlmstpsnonwrfldnon_ainvpknlmstpsnonwrfldnon_medic","ainvpknlmstpsnonwrfldnon_medic","ainvpknlmstpsnonwrfldnon_medic0s","ainvpknlmstpsnonwrfldnon_medic1","ainvpknlmstpsnonwrfldnon_medic0","ainvpknlmstpsnonwrfldnon_medic3","ainvpknlmstpsnonwrfldnon_medic2","ainvpknlmstpsnonwrfldnon_medicend","amovpercmstpsraswrfldnon_amovpercmstpsraswlnrdnon","amovpercmstpsraswlnrdnon","aidlpercmstpsraswlnrdnon_player_s0","aidlpercmstpsraswlnrdnon_player_idlesteady03","amovpercmwlksraswlnrdf","amovpercmrunsraswlnrdf","amovpercmrunsraswlnrdfl","amovpercmrunsraswlnrdl","amovpercmrunsraswlnrdbl","amovpercmrunsraswlnrdb","amovpercmrunsraswlnrdbr","amovpercmrunsraswlnrdr","amovpercmrunsraswlnrdfr","aidlpercmstpsraswlnrdnon_player_idlesteady02","amovpercmstpsraswlnrdnon_amovpercmstpsraswrfldnon","amovpercmstpsraswlnrdnon_amovpknlmstpsraswlnrdnon","amovpknlmstpsraswlnrdnon","aidlpknlmstpsraswlnrdnon_player_0s","amovpknlmwlksraswlnrdf","amovpknlmrunsraswlnrdf","amovpknlmrunsraswlnrdfl","amovpknlmrunsraswlnrdl","amovpknlmrunsraswlnrdbl","amovpknlmrunsraswlnrdb","amovpknlmrunsraswlnrdbr","amovpknlmrunsraswlnrdr","amovpknlmrunsraswlnrdfr","amovpknlmstpsraswlnrdnon_turnl","amovpknlmstpsraswlnrdnon_amovpknlmstpsraswrfldnon","ainvpknlmstpsnonwrfldnon_medic4","ainvpknlmstpsnonwrfldnon_medic5","amovpknlmwlksraswrfldf","amovpknlmwlkslowwrfldf","aidlpknlmstpslowwrfldnon_player_idlesteady04","aidlpknlmstpslowwrfldnon_player_idlesteady03","amovpercmstpsraswrfldnon_amovpercmstpslowwrfldnon","amovpercmstpslowwrfldnon_amovpsitmstpsraswrfldnon","amovpsitmstpsraswrfldnon","amovpsitmstpsraswrfldnon_amovpercmstpslowwrfldnon","amovpercmstpsraswrfldnon_salutein","amovpercmstpsraswrfldnon_salute","amovpercmstpsraswrfldnon_saluteout","aidlpercmstpslowwrfldnon_player_idlesteady04","amovpercmstpslowwrfldnon_player_idlesteady02","amovpercmstpsraswrfldnon_amovpercmstpsraswpstdnon","amovpercmstpsraswrfldnon_amovpercmstpsraswpstdnon_end","amovpercmstpsraswpstdnon","aidlpercmstpsraswpstdnon_player_0s","aidlpercmstpsraswpstdnon_player_idlesteady02","amovpercmstpsraswpstdnon_amovpercmstpsraswrfldnon","amovpercmstpsraswpstdnon_amovpercmstpsraswrfldnon_end","aidlpercmstpsraswpstdnon_player_idlesteady01","aidlpercmstpsraswpstdnon_player_idlesteady03","amovppnemrunslowwrfldl","amovppnemstpsraswrfldnon_amovppnemevaslowwrfldl","amovppnemstpsraswrfldnon_amovppnemevaslowwrfldr","amovppnemstpsraswrfldnon_amovppnemstpsraswpstdnon","amovppnemstpsraswrfldnon_amovppnemstpsraswpstdnon_end","amovppnemstpsraswpstdnon","amovppnemstpsraswpstdnon_amovpercmstpsraswpstdnon","amovpercmstpsraswpstdnon_amovppnemstpsraswpstdnon","amovppnemstpsraswpstdnon_amovppnemstpsraswrfldnon","amovppnemstpsraswpstdnon_amovppnemstpsraswrfldnon_end","amovpknlmstpsraswrfldnon_amovpknlmstpsraswpstdnon","amovpknlmstpsraswrfldnon_amovpknlmstpsraswpstdnon_end","amovpknlmstpsraswpstdnon","aidlpknlmstpsraswpstdnon_player_0s","aidlpknlmstpsraswpstdnon_player_idlesteady01","amovpknlmstpsraswpstdnon_amovpknlmstpsraswrfldnon","amovpknlmstpsraswpstdnon_amovpknlmstpsraswrfldnon_end","aidlpknlmstpsraswpstdnon_player_idlesteady02","aidlpknlmstpsraswpstdnon_player_idlesteady03","aidlpercmstpsraswlnrdnon_player_idlesteady01","amovpknlmstpsraswlnrdnon_amovppnemstpsnonwnondnon","amovppnemstpsnonwnondnon","amovppnemstpsnonwnondnon_amovppnemstpsraswrfldnon","amovpercmstpsraswlnrdnon_amovppnemstpsnonwnondnon","amovpercmstpsraswrfldnon_amovpknlmstpslowwrfldnon","amovpercmstpsraswrfldnon_gear","amovpknlmstpslowwrfldnon_amovpercmstpsraswrfldnon","amovpknlmstpsraswrfldnon_amovpknlmstpslowwrfldnon","amovpknlmstpsraswrfldnon_gear","amovpercmstpsraswrfldnon_diary","amovpknlmstpsraswrfldnon_diary","amovpercmwlksraswrfldbl","amovpercmwlksraswrfldb","amovpercmwlksraswrfldr","amovpknlmwlksraswrfldfr","amovpknlmwlksraswrfldbl","amovpknlmwlksraswrfldfl","amovpercmwlksraswrfldfr","amovpercmwlksraswrfldfl","aovrpercmstpsraswrfldf","amovpknlmstpsraswrfldnon_amovpknlmstpsraswlnrdnon","amovpsitmstpsraswrfldnon_smoking","amovpsitmstpsraswrfldnon_weaponcheck1","amovpsitmstpsraswrfldnon_weaponcheck2","amovpsitmstpsraswrfldnon_trans","amovpercmwlksraswpstdf","amovpercmrunsraswpstdf","amovpercmevasraswpstdf","amovpercmrunsraswpstdfl","amovpercmrunsraswpstdl","amovpercmrunsraswpstdfr","amovpercmrunsraswpstdr","amovpercmrunsraswpstdbr","amovpercmrunsraswpstdb","amovpercmrunsraswpstdbl","amovpercmsprslowwpstdf_amovppnemstpsraswpstdnon","amovpercmsprslowwpstdf_amovppnemstpsraswpstdnon_2","amovppnemrunslowwpstdf","amovppnemrunslowwpstdfr","amovppnemrunslowwpstdr","amovppnemrunslowwpstdbr","amovppnemrunslowwpstdb","amovppnemrunslowwpstdbl","amovppnemrunslowwpstdl","amovppnemrunslowwpstdfl","amovppnemstpsraswpstdnon_amovpknlmstpsraswpstdnon","amovpknlmrunsraswpstdb","amovpercmstpsraswpstdnon_amovpknlmstpsraswpstdnon","amovpknlmstpsraswpstdnon_amovpercmstpsraswpstdnon","amovppnemstpsraswpstdnon_amovpercmsprslowwpstdf","amovppnemstpsraswpstdnon_amovpercmsprslowwpstdf_2","amovpknlmrunsraswpstdf","aovrpercmstpsraswpstdf","amovpercmwlksraswpstdb","amovpknlmstpsraswpstdnon_amovppnemstpsraswpstdnon","amovpknlmrunsraswpstdr","amovpercmwlksraswpstdl","amovpknlmrunsraswpstdl","amovpknlmrunsraswpstdbl","amovpercmwlksraswpstdfr","amovpercmwlksraswpstdfl","amovpknlmrunsraswpstdfl","amovpknlmrunsraswpstdbr","amovpknlmrunsraswpstdfr","amovppnemstpsraswpstdnon_amovppnemevaslowwpstdl","amovppnemstpsraswpstdnon_amovppnemevaslowwpstdr","amovpknlmwlksraswpstdf","pistolmagazinereloadprone","amovpknlmwlksraswpstdbl","amovpknlmwlksraswpstdr","amovpknlmwlksraswpstdl","amovpknlmwlksraswpstdb","amovpercmwlksraswrfldl","amovpercmwlksraswpstdr","amovpercmwlksraswlnrdl","amovpercmwlksraswlnrdr","amovpercmwlksraswlnrdb","amovpercmwlksraswrfldbr","amovpercmwlksraswrfldnon_transition","amovpknlmwlksraswrfldnon_transition","amovpknlmwlksraswrfldbr","amovpknlmwlkslowwrfldb","amovpknlmwlkslowwrfldl","amovpknlmwlkslowwrfldfl","amovpknlmwlkslowwrfldfr","amovpknlmwlkslowwrfldbr","amovpknlmwlkslowwrfldbl","amovpercmwlkslowwrfldb","amovpercmwlkslowwrfldr","amovpercmwlkslowwrfldl","amovpercmwlkslowwrfldbl","amovpercmwlkslowwrfldbr","amovpercmwlkslowwrfldfr","amovpercmwlkslowwrfldfl","amovpercmstpslowwrfldnon_player_idlesteady01","amovppnemrunslowwrfldbl","amovppnemrunslowwrfldbr","amovppnemrunslowwrfldfr","amovppnemrunslowwrfldfl","amovpercmstpsnonwnondnon_zevl","amovpercmstpsnonwnondnon","amovpercmstpsnonwnondnon_amovpercmstpsraswlnrdnon","amovpercmwlksraswlnrdbl","amovpercmwlksraswlnrdfl","amovpercmwlksraswlnrdfr","amovpercmwlksraswlnrdbr","amovpknlmwlksraswlnrdr","amovpknlmwlksraswlnrdl","amovpknlmwlksraswlnrdb","amovpknlmwlksraswlnrdbl","amovpknlmwlksraswlnrdbr","amovpknlmwlksraswlnrdfr","amovpknlmwlksraswlnrdfl","amovpercmwlksraswpstdbl","amovpercmwlksraswpstdbr","amovpknlmwlksraswpstdbr","amovpknlmwlksraswpstdfl","amovpknlmwlksraswpstdfr"];
		if (lifestate _unit == "ALIVE" or !(captive _unit) or tolower animationState _unit in _aliveAnimationState) then {
			_unit playactionnow "agonyStart";
			_unit setUnconscious true;
			_unit setcaptive true;
		};		
		if(_veh != _unit)then{
			if(!(_veh isKindOf "ParachuteBase"))then{
				_unit action ["Eject", _veh];
			};
		};
	};		
};
